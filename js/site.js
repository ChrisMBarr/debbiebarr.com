(()=>{const L=document.querySelector("body"),p=document.querySelector("#header"),S=document.querySelector("#toggle-sidebar"),v=document.querySelector("#sidebar"),E=document.querySelector("#close-sidebar"),g=Array.from(document.querySelectorAll("#sidebar a, #sidebar button")),y=document.querySelector("#sidebar-backdrop"),h=document.querySelectorAll("#book-details-content .sub-navigation a"),d=location.pathname.toLowerCase().trim();g.forEach(e=>e.tabIndex=-1);let o=!1;function u(){L.classList.toggle("sidebar-open",o),o?v.focus():document.activeElement.blur(),g.forEach(e=>e.tabIndex=o?0:-1)}function b(e){e.preventDefault(),o=!1,u()}if(document.body.addEventListener("keyup",e=>{o&&e.key==="Escape"&&(o=!1,u())},!1),S.addEventListener("click",e=>{e.preventDefault(),o=!o,u()},!1),E.addEventListener("click",b,!1),y.addEventListener("click",b,!1),y.addEventListener("touchstart",b,!1),!d.includes("books-for-caregivers")&&/\/books\/.+$/i.test(d)){const m=document.querySelector("#book-details-titles"),t=document.querySelector("#book-details-links"),n=()=>{const r=m.getBoundingClientRect(),c=300-Math.round(r.bottom-p.offsetHeight);t.style.marginTop=`${c}px`};let a=null;window.addEventListener("resize",()=>{clearTimeout(a),a=setTimeout(n,500)}),n(),h.forEach(r=>{r.addEventListener("click",c=>{c.preventDefault(),h.forEach(i=>{i.classList.remove("current"),document.querySelector(i.getAttribute("href")).classList.add("d-none")}),r.classList.add("current"),document.querySelector(r.getAttribute("href")).classList.remove("d-none")})})}if(d.includes("/contact")){const e=document.querySelector("#contact-form"),m=e.querySelectorAll("input,textarea"),t=document.querySelector("#form-status"),n="text-success",a="text-danger",r="Thanks! I'll be in contact with you soon!",c="Oops! There was a problem submitting your message, try again later!";e.addEventListener("submit",async function(s){if(s.preventDefault(),s.stopPropagation(),e.classList.add("was-validated"),e.checkValidity()){const q=new FormData(s.target);fetch(s.target.action,{method:e.method,body:q,headers:{Accept:"application/json"}}).then(l=>{l.ok?i():l.json().then(f=>{Object.hasOwn(f,"errors")?(t.classList.add(a),t.innerHTML=f.errors.map($=>$.message).join(", ")):k(f)})}).catch(l=>k(l))}});const i=()=>{t.innerHTML=r,t.classList.remove(a),t.classList.add(n),m.forEach(s=>{s.setAttribute("readonly",""),s.classList.add("is-valid")}),e.querySelector("button").disabled=!0},k=s=>{t.classList.add(a),t.innerHTML=c,console.error(s)}}})();
